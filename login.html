<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BJC PRIME LOGIN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family: Arial, sans-serif;
    background:#111;
    color:white;
    text-align:center;
    padding:40px;
}
.box{
    background:#222;
    padding:20px;
    border-radius:10px;
    max-width:350px;
    margin:auto;
}
input{
    width:100%;
    padding:12px;
    margin-top:10px;
    border:none;
    border-radius:8px;
}
button{
    margin-top:15px;
    width:100%;
    padding:12px;
    border:none;
    background:#00a8ff;
    color:white;
    font-size:18px;
    border-radius:8px;
}
</style>

<!-- IMPORTANT: Dapat nasa same folder itong file -->
<script src="license.js"></script>

</head>
<body>

<h2>BJC PRIME LOGIN</h2>

<div class="box">
    <input id="code" placeholder="Enter License Code">
    <button onclick="login()">LOGIN</button>
</div>

<script>
if (typeof LICENSES === "undefined") {
    alert("License data not loaded!");
}

// Generate Device ID
function getDeviceID() {
    return btoa(navigator.userAgent).substring(0, 20);
}

function login() {
    const input = document.getElementById("code").value.trim();
    const deviceID = getDeviceID();

    if (input === "") {
        alert("Enter License Code");
        return;
    }

    let valid = false;

    for (let lic of LICENSES) {
        if (lic.code === input) {

            if (lic.device === null) {
                lic.device = deviceID; // FIRST TIME LOGIN
            }

            if (lic.device !== deviceID) {
                alert("LICENSE LOCKED TO ANOTHER DEVICE!");
                return;
            }

            const now = new Date();
            const exp = new Date(lic.expire);

            if (now > exp) {
                alert("LICENSE EXPIRED!");
                return;
            }

            valid = true;
            break;
        }
    }

    if (!valid) {
        alert("INVALID LICENSE!");
        return;
    }

    alert("LOGIN SUCCESS!");
    window.location.href = "main.html"; // palitan mo kung ano home page mo
}
</script>

</body>
</html>    return id;
}

function showError(txt){
    const e = document.getElementById("error");
    e.innerText = txt;
    e.style.display = "block";
}

async function login(){
    const code = document.getElementById("code").value.trim();
    const device = getDeviceID();

    if(!code){
        showError("Please enter your access code.");
        return;
    }

    // Ensure LICENSES is loaded
    if (typeof LICENSES === "undefined") {
        showError("License data not loaded.");
        return;
    }

    const user = LICENSES.find(x => x.code === code);
    if(!user){
        showError("Invalid code.");
        return;
    }

    const expire = new Date(user.expire + " 23:59:59");
    if(expire < new Date()){
        showError("Your code has expired.");
        return;
    }

    // DEVICE LOCK â€” still local-only
    if(!user.device){
        user.device = device;
        localStorage.setItem("bjc_device", device);
    }
    else if(user.device !== device){
        showError("This code is already used on another device.");
        return;
    }

    localStorage.setItem("bjc_logged", "1");
    localStorage.setItem("bjc_code", code);

    window.location.href = "index.html";
}
</script>

</body>
</html>
